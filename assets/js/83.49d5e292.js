(window.webpackJsonp=window.webpackJsonp||[]).push([[83],{442:function(t,s,a){"use strict";a.r(s);var n=a(27),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"bit-位运算"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#bit-位运算"}},[t._v("#")]),t._v(" bit 位运算")]),t._v(" "),s("p",[t._v("本页面中主要记录在"),s("code",[t._v("React")]),t._v("源码中的位运算")]),t._v(" "),s("h2",{attrs:{id:"位运算在权限系统中的使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#位运算在权限系统中的使用"}},[t._v("#")]),t._v(" 位运算在权限系统中的使用")]),t._v(" "),s("p",[t._v("传统的权限系统重，存在很多的关联关系，如用户和权限的关联，用户和角色的关联。系统越大，关联关系越多，越难以维护。而引入位运算，可以巧妙的解决这个问题。")]),t._v(" "),s("ul",[s("li",[t._v("每种权限码都是唯一的")]),t._v(" "),s("li",[t._v("所有权限码的二进制数形式，有且只有一位值为 1，其与全部为 0("),s("code",[t._v("2^n")]),t._v(")")])]),t._v(" "),s("p",[t._v("如果用户权限和权限码全部使用二进制数字表示，再结合或运算"),s("code",[t._v("|")]),t._v("或者与运算"),s("code",[t._v("&")]),t._v("可以进行：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("|")]),t._v("或运算可以用来赋予权限")]),t._v(" "),s("li",[s("code",[t._v("&")]),t._v("与运算可以用来校验权限")])]),t._v(" "),s("p",[t._v("如在"),s("code",[t._v("Linux")]),t._v("系统中的文件权限，其分为读、写以及执行，有字母和数字等多种表现形式")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("权限")]),t._v(" "),s("th",[t._v("字母表示")]),t._v(" "),s("th",[t._v("数字表示")]),t._v(" "),s("th",[t._v("二进制")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("读权限")]),t._v(" "),s("td",[t._v("r")]),t._v(" "),s("td",[t._v("4")]),t._v(" "),s("td",[s("code",[t._v("0b100")])])]),t._v(" "),s("tr",[s("td",[t._v("写权限")]),t._v(" "),s("td",[t._v("w")]),t._v(" "),s("td",[t._v("2")]),t._v(" "),s("td",[s("code",[t._v("0b010")])])]),t._v(" "),s("tr",[s("td",[t._v("执行权限")]),t._v(" "),s("td",[t._v("x")]),t._v(" "),s("td",[t._v("1")]),t._v(" "),s("td",[s("code",[t._v("0b001")])])]),t._v(" "),s("tr",[s("td",[t._v("无权限")]),t._v(" "),s("td",[t._v("-")]),t._v(" "),s("td",[t._v("0")]),t._v(" "),s("td",[s("code",[t._v("0b000")])])])])]),t._v(" "),s("h3",{attrs:{id:"添加权限"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#添加权限"}},[t._v("#")]),t._v(" 添加权限")]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" r "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0b100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" w "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0b010")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" x "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0b001")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 给用户赋予全部权限，使用或|操作，结果为 0b111;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" user "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" r "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" w "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"校验权限"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#校验权限"}},[t._v("#")]),t._v(" 校验权限")]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" r "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0b100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" w "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0b010")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" x "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0b001")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 给用户赋予全部权限，使用或|操作，结果为 0b110;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" user "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" r "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" w"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   user: 0b110")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//      r: 0b100")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// user&r: 0b100")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("console")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("user "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" r"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" r"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// true，有r权限")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   user: 0b110")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//      w: 0b010")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// user&w: 0b010")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("console")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("user "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" w"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" w"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// true，有w权限")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   user: 0b110")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//      x: 0b001")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// user&x: 0b000")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("console")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("user "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// false，没有x权限")]),t._v("\n")])])]),s("p",[t._v("根据上面代码可以使用 "),s("strong",[t._v("用户权限 & 权限 code === 权限 code")]),t._v(" 是否为"),s("code",[t._v("true")]),t._v("来判断是否有该权限")]),t._v(" "),s("h3",{attrs:{id:"删除权限"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#删除权限"}},[t._v("#")]),t._v(" 删除权限")]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" r "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0b100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" w "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0b010")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" x "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0b001")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" user "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0b110")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 有 r w 两个权限")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 执行异或操作")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//     user: 0b110;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//        r: 0b100;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// user ^ r: 0b010;")]),t._v("\nuser "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" user "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("^")]),t._v(" r"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   user: 0b010")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//      r: 0b100")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// user&r: 0b000")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("console")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("user "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" r"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" r"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// false，没有r权限")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   user: 0b010")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//      w: 0b010")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// user&w: 0b010")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("console")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("user "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" w"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" w"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// true，有w权限")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   user: 0b010")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//      x: 0b001")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// user&x: 0b000")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("console")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("user "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// false，没有x权限")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 再执行一次异或操作")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//     user: 0b010;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//        r: 0b100;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// user ^ r: 0b110;")]),t._v("\nuser "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" user "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("^")]),t._v(" r"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("在上面的执行过程中，先使用异或操作删除了"),s("code",[t._v("r")]),t._v("权限，但是再次对"),s("code",[t._v("user")]),t._v("进行"),s("code",[t._v("r")]),t._v("的异或操作，发现原本没有"),s("code",[t._v("r")]),t._v("权限的值再异或结果后又有了其权限的值，这样是不正常的。")]),t._v(" "),s("p",[t._v("如果想只是删除权限（而不是无则增，有则减），需要怎么做呢？答案是执行 "),s("code",[t._v("&(~code)")]),t._v("，先取反，再执行与操作")]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" r "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0b100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" w "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0b010")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" x "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0b001")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" user "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0b110")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 有 r w 两个权限")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 执行删除&(~code)操作")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//      user: 0b110;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//        ~r: 0b011;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// user & ~r: 0b010;")]),t._v("\nuser "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" user "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),t._v("r"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   user: 0b010")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//      r: 0b100")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// user&r: 0b000")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("console")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("user "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" r"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" r"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// false，没有r权限")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   user: 0b010")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//      w: 0b010")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// user&w: 0b010")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("console")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("user "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" w"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" w"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// true，有w权限")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   user: 0b010")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//      x: 0b001")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// user&x: 0b000")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("console")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("user "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// false，没有x权限")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 再执行一次删除操作")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//      user: 0b010;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//        ~r: 0b011;")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// user & ~r: 0b010;")]),t._v("\nuser "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" user "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),t._v("r"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("可以看到，当前面删除完"),s("code",[t._v("r")]),t._v("权限之后，再使用"),s("code",[t._v("&(~code)")]),t._v("执行删除操作，其结果都是一致的，不会出现"),s("strong",[t._v("无则增，有则减")]),t._v("的现象")]),t._v(" "),s("h3",{attrs:{id:"局限性和解决办法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#局限性和解决办法"}},[t._v("#")]),t._v(" 局限性和解决办法")]),t._v(" "),s("p",[t._v("上面的权限运算都有前提条件，也就是：")]),t._v(" "),s("ul",[s("li",[t._v("每种权限码都是唯一的")]),t._v(" "),s("li",[t._v("所有权限码的二进制数形式，有且只有一位值为 1，其与全部为 0("),s("code",[t._v("2^n")]),t._v(")")])]),t._v(" "),s("p",[t._v("那么在同一个应用下可用的权限数就非常有限，这也是该方案的局限性。为了突破这个限制，提出了一个叫做“权限空间”的概念，既然权限数量有限，那么就可以多开辟几个空间来存放。")])])}),[],!1,null,null,null);s.default=e.exports}}]);